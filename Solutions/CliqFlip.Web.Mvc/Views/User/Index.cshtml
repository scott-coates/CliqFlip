@using System.Configuration
@using System.Globalization
@using CliqFlip.Domain.Common
@model CliqFlip.Web.Mvc.ViewModels.User.UserProfileIndexViewModel
@if (Model.CanEdit)
{
	<div class="uploadProfileImage">
		@using (Html.BeginForm("SaveProfileImage", "User", FormMethod.Post, new {@encType = "multipart/form-data"}))
		{
			@Html.ValidationSummary()
			@FileUpload.GetHtml("profileImage", initialNumberOfFiles: 1, allowMoreFilesToBeAdded: false, uploadText: "Upload Photo")
		}
	</div>
}
<!-- Blog Post -->
<div class="blog-post">
	<div class="post-entry">
		<div class="headline" id="profileHeadline">
			<h2 id="headlineText">@Model.Headline</h2>
		</div>
		<p id="saveMindMapText">
			Mind map saved</p>
		<div id="mindMap" class="profileMindMap">
		</div>
		<div id="profileBio" class="bio">
			<p id="bioText">@Model.Bio</p>
		</div>
	</div>
</div>
<!-- END Blog Post -->
<!-- SIDEBAR START -->
<div class="sidebar">
	<!-- SIDEBAR SEARCH START -->
	<div class="sidebar_item">
		<div class="search">
			<input class="search_submit" value="" type="submit">
			<input class="search_box" type="text" value="Search..." onfocus="if (this.value == 'Search...') {this.value = '';}"
				   onblur="if (this.value == '') {this.value = 'Search...';}">
		</div>
	</div>
	<!-- SIDEBAR SEARCH END -->
	<!-- SIDEBAR RECENT POSTS START -->
	<div class="sidebar_item recent-posts">
		<strong>Link CliqFlip to your other social networks</strong>
		<ul>
			<li>
				@{ string attr = Model.CanEdit ? "class='editable'" : ""; }
				<div id="facebook-connect" @Html.Raw(attr) >
					<img src="@Url.Content("~/Content/img/f_logo.png")" alt="Facebook" />
					<p class="facebookText">
						@if (String.IsNullOrWhiteSpace(Model.FacebookUsername))
						{
							if (Model.CanEdit)
							{
								<a id="facebook-connect" href="javascript:void(0)">Link to Facebook</a>
							}
						}
						else
						{
							<text>Linked...</text>
						}
					</p>
				</div>
			</li>
			<li>
				<div id="twitterUsername">
					<img src="https://si0.twimg.com/a/1329332580/images/logos/twitter_newbird_blue.png"
						 alt="Twitter" />
					<p id="twitterUsernameText" class="twitterUsernameText">@Model.TwitterUsername</p>
				</div>
			</li>
			<li>
				<div id="youTubeUsername">
					<img src="http://s.ytimg.com/yt/img/creators_corner/YouTube/40x40_yt_white.png" alt="Twitter" />
					<p id="youTubeUsernameText" class="youTubeUsernameText">@Model.YouTubeUsername</p>
				</div>
			</li>
			<li>
				<div id="websiteUrl">
					<img src="http://blog.zobristinc.com/wp-content/themes/dfblog/images/icons/RSS_Logo.png"
						 alt="Website" />
					<p id="websiteUrlText" class="websiteUrlText">@Model.WebsiteUrl</p>
				</div>
			</li>
		</ul>
	</div>
	<!-- SIDEBAR RECENT POSTS END -->
</div>
<!-- SIDEBAR END -->
<div id="fb-root">
</div>
@section scripts
{
	<script type="text/javascript" src="@Url.Content("/Content/js/jquery.json.js")"> </script>
	<script type="text/javascript" src="@Url.Content("/Content/js/raphael/raphael.js")"> </script>
	<script type="text/javascript" src="@Url.Content("/Content/js/raphael/graffle.js")"> </script>
	<script type="text/javascript" src="@Url.Content("/Content/js/raphael/raphael.cliqFlip.js")"> </script>
	<script type="text/javascript" src="@Url.Content("/Content/js/user/profile.js")"> </script>
	<script type="text/javascript" src="@Url.Content("/Content/js/cliqFlip/ui.js")"> </script>
	<script type="text/javascript" src="@Url.Content("/Content/js/jquery.jeip.js")"> </script>
	<script type="text/javascript">
		//TODO: Only load FB if user can edit
		InitFacebookSdk('@ConfigurationManager.AppSettings[Constants.FACEBOOK_APPID]');
		$(function() {
			InitUser(@(Model.CanEdit.ToString(CultureInfo.InvariantCulture).ToLower()));
			InitHeadline(@(Html.Raw(Model.SaveHeadlineUrl)));
			InitBio(@(Html.Raw(Model.SaveBioUrl)));
			InitMindMap(@(Html.Raw(Model.InterestsJson)), @(Html.Raw(Model.SaveMindMapUrl)));
			InitTwitterUsername(@(Html.Raw(Model.SaveTwitterUsernameUrl)));
			InitYouTubeUsername(@(Html.Raw(Model.SaveYouTubeUsernameUrl)));
			InitWebsiteUrl(@(Html.Raw(Model.SaveWebsiteUrl)));
			InitFacebook();
		});
	</script>
}